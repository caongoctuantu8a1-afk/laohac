<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Anh h√πng c·ª©u L√£o H·∫°c</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{margin:0;overflow:hidden;font-family:Segoe UI,sans-serif;background:#000}

#game{
 width:100vw;height:100vh;
 background:#222;
 position:relative;
}

/* Screens */
.screen{
 position:absolute;top:0;left:0;
 width:100%;height:100%;
 background:rgba(0,0,0,.85);
 display:flex;
 flex-direction:column;
 align-items:center;
 justify-content:center;
 color:white;
 z-index:10;
}
.hidden{display:none}

button{
 padding:14px 36px;
 font-size:22px;
 border:none;
 border-radius:40px;
 background:linear-gradient(135deg,#ffd000,#ff8c00);
 font-weight:bold;
 cursor:pointer;
}

/* HUD */
#hud{
 position:absolute;top:10px;left:10px;
 color:white;font-size:16px;
 z-index:5;
}
#hpWrap{
 width:160px;height:14px;
 border:2px solid white;border-radius:10px;
 overflow:hidden;margin-top:5px;
}
#hpBar{
 height:100%;width:100%;
 background:linear-gradient(to right,#00ff55,#aaff00);
}

/* World */
#ground{
 position:absolute;bottom:0;left:0;
 width:100%;height:80px;
 background:#333;
}

/* Hero */
#hero{
 position:absolute;
 bottom:80px;left:80px;
 width:60px;height:80px;
 background:red; /* t·∫°m m√†u ƒë·ªè, thay b·∫±ng hero.png */
}

/* Obstacle */
.obstacle{
 position:absolute;
 bottom:80px;
 width:50px;height:50px;
 background:green; /* t·∫°m m√†u xanh, thay b·∫±ng rock.png */
}

/* Gate */
#gate{
 position:absolute;
 bottom:80px;
 width:80px;height:100px;
 background:blue; /* t·∫°m m√†u xanh d∆∞∆°ng, thay b·∫±ng gate.png */
}

/* Question box */
#questionBox{
 position:absolute;
 bottom:100px;
 left:0;right:0;margin:auto;
 width:92%;max-width:600px;
 background:rgba(0,0,0,.9);
 border-radius:20px;
 padding:20px;
 color:white;
 z-index:9;
 display:none;
}
textarea{
 width:100%;height:80px;
 border-radius:10px;border:none;
 padding:10px;font-size:16px;
}
</style>
</head>

<body>

<div id="game">

<!-- START -->
<div id="startScreen" class="screen">
 <h1>üèÉ Anh h√πng c·ª©u L√£o H·∫°c</h1>
 <p>Ch·∫°y ‚Äì Nh·∫£y ‚Äì Tr·∫£ l·ªùi c√¢u h·ªèi ƒë·ªÉ v∆∞·ª£t bi k·ªãch</p>
 <button id="btnStart">B·∫ÆT ƒê·∫¶U</button>
</div>

<!-- GAME OVER -->
<div id="gameOver" class="screen hidden">
 <h1>üíÄ GAME OVER</h1>
 <button id="btnRestart">CH∆†I L·∫†I</button>
</div>

<!-- HUD -->
<div id="hud">
 ‚ù§Ô∏è M√°u
 <div id="hpWrap"><div id="hpBar"></div></div>
</div>

<!-- WORLD -->
<div id="hero"></div>
<div id="ground"></div>

<!-- QUESTION -->
<div id="questionBox">
 <div id="q"></div>
 <textarea id="ans"></textarea>
 <button id="btnAnswer">V∆Ø·ª¢T C·ªîNG</button>
</div>

</div>

<script>
window.onload = function(){

/* ============================
   KHAI B√ÅO BI·∫æN
============================ */
const hero = document.getElementById("hero");
const game = document.getElementById("game");
const ans = document.getElementById("ans");

const startScreen = document.getElementById("startScreen");
const gameOverScreen = document.getElementById("gameOver");
const questionBox = document.getElementById("questionBox");

let heroY=0, velY=0, gravity=0.8, jumping=false;
let obstacles=[], gate=null;
let hp=100, qIndex=0, playing=false;
let gameLoopId;

/* ============================
   C√ÇU H·ªéI
============================ */
const questions=[
{q:"T√°c gi·∫£ L√£o H·∫°c l√† ai?",keys:["nam cao"]},
{q:"C·∫≠u V√†ng l√† con g√¨?",keys:["ch√≥"]},
{q:"V√¨ sao l√£o H·∫°c b√°n C·∫≠u V√†ng?",keys:["ngh√®o"]},
{q:"Ho√†n c·∫£nh s·ªëng c·ªßa l√£o H·∫°c?",keys:["ngh√®o","c√¥ ƒë∆°n"]},
{q:"T√¢m tr·∫°ng l√£o H·∫°c sau khi b√°n ch√≥?",keys:["ƒëau","√¢n h·∫≠n","day d·ª©t"]},
{q:"Bi·ªÉu hi·ªán l√≤ng t·ª± tr·ªçng c·ªßa l√£o H·∫°c?",keys:["t·ª± tr·ªçng","kh√¥ng nh·∫≠n"]},
{q:"Vai tr√≤ c·ªßa √¥ng gi√°o trong truy·ªán?",keys:["ch·ª©ng ki·∫øn","nh√¢n ƒë·∫°o"]},
{q:"Gi√° tr·ªã hi·ªán th·ª±c c·ªßa L√£o H·∫°c?",keys:["x√£ h·ªôi","ngh√®o"]},
{q:"Gi√° tr·ªã nh√¢n ƒë·∫°o c·ªßa truy·ªán?",keys:["nh√¢n ƒë·∫°o","c·∫£m th√¥ng"]},
{q:"√ù nghƒ©a c√°i ch·∫øt c·ªßa l√£o H·∫°c?",keys:["bi k·ªãch","t·ªë c√°o"]},
];

/* ============================
   START / RESET
============================ */
function startGame(){
 startScreen.classList.add("hidden");
 playing=true;
 spawnObstacle();
 loop();
}

function resetGame(){
 location.reload();
}

/* ============================
   LOOP GAME
============================ */
function loop(){
 if(!playing) return;

 // gravity
 velY += gravity;
 heroY += velY;
 if(heroY<0){ heroY=0; velY=0; jumping=false; }
 hero.style.bottom = (80+heroY)+"px";

 // obstacles
 obstacles.forEach(o=>{
  o.x -= 6;
  o.el.style.left = o.x+"px";
  if(checkHit(o.el)){
   hp -= 20; updateHP();
   o.x = -100;
   if(hp<=0) endGame();
  }
 });

 // gate
 if(gate){
  gate.x -= 6;
  gate.el.style.left = gate.x + "px";
  if(checkHit(gate.el)){
   openQuestion();
  }
 }

 gameLoopId = requestAnimationFrame(loop);
}

/* ============================
   NH·∫¢Y
============================ */
document.addEventListener("keydown", e=>{
 if(e.code==="Space" && !jumping){ velY=15; jumping=true; }
});
document.addEventListener("touchstart", ()=>{
 if(!jumping){ velY=15; jumping=true; }
});

/* ============================
   SPAWN OBSTACLE & GATE
============================ */
function spawnObstacle(){
 let o = document.createElement("div");
 o.className="obstacle";
 o.x = window.innerWidth;
 o.style.left = o.x + "px";
 game.appendChild(o);
 obstacles.push({el:o, x:o.x});

 setTimeout(spawnGate, 4000);
 setTimeout(spawnObstacle, Math.random()*2000 + 2000);
}

function spawnGate(){
 if(gate) return;
 gate = {el: document.createElement("div"), x: window.innerWidth};
 gate.el.id="gate";
 gate.el.style.left = gate.x + "px";
 game.appendChild(gate.el);
}

/* ============================
   COLLISION
============================ */
function checkHit(el){
 let h = hero.getBoundingClientRect();
 let o = el.getBoundingClientRect();
 return !(h.right < o.left || h.left > o.right || h.bottom < o.top || h.top > o.bottom);
}

/* ============================
   C√ÇU H·ªéI
============================ */
function openQuestion(){
 playing=false;
 if(gate){ gate.el.remove(); gate=null; }
 questionBox.style.display="block";
 document.getElementById("q").innerText = questions[qIndex].q;
}

function checkAnswer(){
 let a = ans.value.toLowerCase();
 let hit = 0;
 questions[qIndex].keys.forEach(k=>{ if(a.includes(k)) hit++; });
 questionBox.style.display="none";
 ans.value = "";
 qIndex++;
 if(hit<1){ hp -= 20; updateHP(); }
 if(qIndex >= questions.length){
  alert("üéâ ƒê√£ c·ª©u ƒë∆∞·ª£c L√£o H·∫°c!");
  resetGame();
  return;
 }
 playing=true;
 spawnObstacle();
}

/* ============================
   HUD
============================ */
function updateHP(){
 document.getElementById("hpBar").style.width = hp+"%";
}

/* ============================
   END GAME
============================ */
function endGame(){
 playing=false;
 gameOverScreen.classList.remove("hidden");
}

/* ============================
   EVENT BUTTONS
============================ */
document.getElementById("btnStart").addEventListener("click", startGame);
document.getElementById("btnRestart").addEventListener("click", resetGame);
document.getElementById("btnAnswer").addEventListener("click", checkAnswer);

/* ============================
   INIT
============================ */
updateHP();

}
</script>

</body>
</html>
